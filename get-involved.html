<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <!-- Meta -->
        <link rel="canonical" href="https://pccrenewal.ca/get-involved.html" />
        <meta
            name="description"
            content="Get Involved with PCC Renewal - Christians in The Presbyterian Church in Canada committed to reforming and renewing the Church according to God's Word"
        />
        <meta property="og:title" content="Get Involved - PCC Renewal" />
        <meta
            property="og:description"
            content="Get Involved with PCC Renewal - Christians in The Presbyterian Church in Canada committed to reforming and renewing the Church according to God's Word"
        />
        <meta property="og:image" content="https://pccrenewal.ca/logo.jpg" />
        <meta
            property="og:url"
            content="https://pccrenewal.ca/get-involved.html"
        />
        <meta property="og:type" content="website" />
        <meta property="twitter:title" content="Get Involved - PCC Renewal" />
        <meta
            property="twitter:description"
            content="Get Involved with PCC Renewal - Christians in The Presbyterian Church in Canada committed to reforming and renewing the Church according to God's Word"
        />

        <!-- Favicon -->
        <link
            rel="apple-touch-icon"
            sizes="180x180"
            href="/apple-touch-icon.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="32x32"
            href="/favicon-32x32.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="16x16"
            href="/favicon-16x16.png"
        />
        <link rel="manifest" href="/site.webmanifest" />
        <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5" />
        <meta name="msapplication-TileColor" content="#da532c" />
        <meta name="theme-color" content="#ffffff" />

        <!-- Title -->
        <title>Get Involved - PCC Renewal</title>

        <!-- CSS -->
        <link rel="stylesheet" href="css/main.css" />
        <link rel="stylesheet" href="css/get-involved.css" />
        <link rel="stylesheet" href="css/scrollbar.css" />
        <link rel="stylesheet" href="css/footer.css" />
    </head>

    <body>
        <div class="page">
            <header class="site-header">
                <nav class="nav">
                    <div class="nav-group nav-left">
                        <a href="/">Home</a>
                        <a href="/motivation.html">Our Motivation</a>
                    </div>
                    <a href="/" class="logo" aria-label="PCC Renewal home">
                        <img src="logo transparent.png" alt="PCC Renewal" />
                    </a>
                    <div class="nav-group nav-right">
                        <a href="/resources.html">Resources</a>
                        <a href="/get-involved.html">Get Involved</a>
                    </div>
                </nav>
            </header>
            <button
                class="hamburger"
                id="hamburger"
                aria-label="Open menu"
                aria-controls="mobile-menu"
                aria-expanded="false"
            >
                <span></span>
                <span></span>
                <span></span>
            </button>
            <div id="mobile-menu" class="mobile-menu" hidden>
                <nav class="mobile-nav" aria-label="Mobile">
                    <a href="/">Home</a>
                    <a href="/motivation.html">Our Motivation</a>
                    <a href="/resources.html">Resources</a>
                    <a href="/get-involved.html">Get Involved</a>
                </nav>
            </div>

            <!-- Hero Section with Strategy Title -->
            <section id="strategy-hero">
                <div class="strategy-hero-inner">
                    <h1 class="strategy-title">Our strategy</h1>
                    <div class="strategy-image-pair">
                        <img
                            src="images/page 4/page 4 pic 2.png"
                            alt="Strategy diagram"
                            class="strategy-image"
                            onclick="openHandbookImage(this)"
                        />
                        <img
                            src="images/page 4/page 4 pic 3 UPDATE.png"
                            alt="Strategy content"
                            class="strategy-image"
                            onclick="openHandbookImage(this)"
                        />
                    </div>
                    <p class="strategy-text small-font">
                        Since theologically liberal churches tend to diminish,
                        we encourage faithful Christians in the PCC to remain in
                        their theologically orthodox/moderate churches (those
                        that rank 0-2 on the progressivism scale), and
                        strengthen them through active involvement in church
                        life, reaching out to their community with the gospel,
                        and reigniting interest in sound doctrine. Over time,
                        the orthodox churches will eventually become the
                        majority.
                    </p>
                </div>
            </section>

            <!-- Two Tiles Section -->
            <section id="tiles-section" class="section section--light">
                <div class="section-inner">
                    <div class="tiles-container">
                        <div class="tile tile-left">
                            <p class="tile-text tile-text-blue">
                                Use our map to find a theologically orthodox
                                mainline church to attend!
                            </p>
                            <img
                                src="images/page 4/page 4 pic 4 NEW 2.png"
                                alt="Map preview"
                                class="tile-bg-image"
                            />
                            <a
                                href="https://www.google.com/maps/d/u/1/edit?mid=1A_q__f9RDi8LYF4bpHMRxnnaBbyP0GQ&usp=sharing"
                                class="tile-button"
                                target="_blank"
                                >Go to map</a
                            >
                        </div>
                        <div class="tile tile-right">
                            <p class="tile-text tile-text-white">
                                Join the PCC Renewal Discord and Reformation
                                Canada Discord to connect with like-minded
                                Christians and find more resources!
                            </p>
                            <div class="discord-icons">
                                <a
                                    href="https://discord.gg/YJrhd9mq5d"
                                    class="discord-icon-link"
                                    target="_blank"
                                >
                                    <img
                                        src="images/page 4/page 4 pic 5 ICON 1.png"
                                        alt="PCC Renewal Discord"
                                        class="discord-icon"
                                    />
                                </a>
                                <a
                                    href="https://discord.gg/FCtMrpXrXa"
                                    class="discord-icon-link"
                                    target="_blank"
                                >
                                    <img
                                        src="images/page 4/page 4 pic 5 ICON 2.png"
                                        alt="Reformation Canada Discord"
                                        class="discord-icon"
                                    />
                                </a>
                            </div>
                            <img
                                src="images/page 4/page 4 pic 5 NEW BG 2.png"
                                alt="Organizations"
                                class="tile-image"
                            />
                        </div>
                    </div>
                </div>
            </section>

            <!-- Social Media Call to Action -->
            <section id="social-cta" class="section section--light">
                <div class="section-inner">
                    <h2 class="social-title">
                        Follow us on Facebook, Instagram, and Youtube to learn
                        about Presbyterian church history, Reformed theology,
                        upcoming events, and to stay up to date with our
                        mission!
                    </h2>
                    <div class="social-links">
                        <a
                            href="https://www.facebook.com/profile.php?id=61574777842350"
                            aria-label="Facebook"
                            target="_blank"
                        >
                            <img
                                src="images/social media icons/fb large.png"
                                alt="Facebook"
                            />
                        </a>
                        <a
                            href="https://www.instagram.com/pccrenewal/"
                            aria-label="Instagram"
                            target="_blank"
                        >
                            <img
                                src="images/social media icons/ig large.png"
                                alt="Instagram"
                            />
                        </a>
                        <a
                            href="https://www.youtube.com/@pccrenewal"
                            aria-label="YouTube"
                            target="_blank"
                        >
                            <img
                                src="images/social media icons/yt large.png"
                                alt="YouTube"
                            />
                        </a>
                    </div>
                </div>
            </section>

            <!-- Mailing List Section -->
            <section id="mailing-list-section" class="section section--light">
                <div class="section-inner">
                    <h2 class="mailing-list-title">Join our mailing list!</h2>
                    <form id="mailing-list-form" class="mailing-list-form">
                        <!-- Multiple honeypots for enhanced bot protection (hidden) -->
                        <input
                            type="text"
                            name="website"
                            id="website"
                            style="display: none"
                            tabindex="-1"
                            autocomplete="off"
                        />
                        <input
                            type="text"
                            name="phone"
                            id="phone"
                            style="display: none"
                            tabindex="-1"
                            autocomplete="off"
                        />
                        <input
                            type="text"
                            name="company"
                            id="company"
                            style="display: none"
                            tabindex="-1"
                            autocomplete="off"
                        />

                        <div class="form-group">
                            <input
                                type="email"
                                id="email"
                                name="email"
                                placeholder="Enter your email here"
                                required
                                class="email-input"
                            />
                            <button
                                type="submit"
                                class="submit-button"
                                id="submit-btn"
                            >
                                <span id="button-text">Submit</span>
                            </button>
                        </div>
                    </form>
                    <div
                        id="form-message"
                        class="form-message"
                        style="display: none"
                    ></div>
                </div>
            </section>

            <!-- Member Handbook Section -->
            <section id="handbook-section" class="section section--light">
                <div class="section-inner">
                    <p class="handbook-text small-font">
                        <strong
                            ><em
                                >Documents that might interest inquirers, such
                                as our Member Handbook that details specific
                                ways to help the movement, are available in our
                                Discord or upon request by email (for allies
                                only).</em
                            ></strong
                        >
                    </p>
                    <div class="handbook-previews">
                        <img
                            src="images/page 4/handbook photos (can click to enlarge but no scrolling between needed)/0 handbook cover.jpg"
                            alt="Member Handbook Cover"
                            class="handbook-image clickable"
                            onclick="openHandbookImage(this)"
                        />
                        <img
                            src="images/page 4/handbook photos (can click to enlarge but no scrolling between needed)/1 table.jpg"
                            alt="Handbook Table of Contents"
                            class="handbook-image clickable"
                            onclick="openHandbookImage(this)"
                        />
                        <img
                            src="images/page 4/handbook photos (can click to enlarge but no scrolling between needed)/2 values.jpg"
                            alt="Handbook Values Page"
                            class="handbook-image clickable"
                            onclick="openHandbookImage(this)"
                        />
                        <img
                            src="images/page 4/handbook photos (can click to enlarge but no scrolling between needed)/3 vision.jpg"
                            alt="Handbook Vision Page"
                            class="handbook-image clickable"
                            onclick="openHandbookImage(this)"
                        />
                    </div>
                </div>
            </section>

            <!-- Contact Section -->
            <section id="contact-section" class="section section--light">
                <div class="section-inner">
                    <h2 class="contact-title">
                        Contact us if you have any questions:
                    </h2>
                    <p class="contact-email">pccrenewal@gmail.com</p>
                </div>
            </section>

            <!-- Disclaimer -->
            <section id="disclaimer" class="section section--light">
                <div class="section-inner">
                    <p class="disclaimer-text small-font">
                        photos on this site do not indicate affiliation and are
                        merely for aesthetic purposes
                    </p>
                    <p class="copyright">Â© 2025 by PCC Renewal</p>
                </div>
            </section>
        </div>

        <!-- Modal for handbook images -->
        <div id="handbook-modal" class="modal" onclick="closeHandbookModal()">
            <img id="modal-image" class="modal-content" />
        </div>

        <script>
            // Mobile menu functionality
            (function () {
                const button = document.getElementById("hamburger");
                const menu = document.getElementById("mobile-menu");
                if (!button || !menu) return;
                button.addEventListener("click", function () {
                    const isOpen =
                        button.getAttribute("aria-expanded") === "true";
                    button.setAttribute("aria-expanded", String(!isOpen));
                    if (isOpen) {
                        menu.setAttribute("hidden", "");
                        document.body.classList.remove("no-scroll");
                    } else {
                        menu.removeAttribute("hidden");
                        document.body.classList.add("no-scroll");
                    }
                });
            })();

            // Handbook image modal functionality
            function openHandbookImage(img) {
                const modal = document.getElementById("handbook-modal");
                const modalImg = document.getElementById("modal-image");
                modal.style.display = "block";
                modalImg.src = img.src;
                modalImg.alt = img.alt;
                document.body.classList.add("no-scroll");
            }

            function closeHandbookModal() {
                const modal = document.getElementById("handbook-modal");
                modal.style.display = "none";
                document.body.classList.remove("no-scroll");
            }

            // Mailing List Form Functionality
            (function () {
                const form = document.getElementById("mailing-list-form");
                const submitButton = document.getElementById("submit-btn");
                const buttonText = document.getElementById("button-text");
                const formMessage = document.getElementById("form-message");
                const emailInput = document.getElementById("email");

                // Obfuscated Google Apps Script Web App URL
                const encodedUrl =
                    "aHR0cHM6Ly9zY3JpcHQuZ29vZ2xlLmNvbS9tYWNyb3Mvcy9BS2Z5Y2J6VnEzdWI0dHN3dFlUVXM0UGNIYkxCRmtoMlpxVWc1MUlMQXBmQWlvS0hCTDdrdm5RT0IzbUJIRml2LVZqeWJCQ1Fidy9leGVj";
                const SCRIPT_URL = atob(encodedUrl);

                // Enhanced bot detection variables
                let formLoadTime = Date.now();
                let mouseMovements = 0;
                let keystrokes = 0;
                let focusEvents = 0;
                let submissionToken = null;

                function showMessage(message, type) {
                    formMessage.textContent = message;
                    formMessage.className = `form-message ${type}`;
                    formMessage.style.display = "block";

                    // Hide message after 5 seconds for success, 7 seconds for error
                    setTimeout(
                        () => {
                            formMessage.style.display = "none";
                        },
                        type === "success" ? 5000 : 7000
                    );
                }

                function setButtonState(loading) {
                    if (loading) {
                        submitButton.disabled = true;
                        buttonText.textContent = "Sending...";
                    } else {
                        submitButton.disabled = false;
                        buttonText.textContent = "Submit";
                    }
                }

                function validateEmail(email) {
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    return emailRegex.test(email);
                }

                // Generate submission token
                function generateSubmissionToken() {
                    return Date.now().toString();
                }

                // Enhanced bot detection setup
                function setupBotDetection() {
                    // Track mouse movements
                    document.addEventListener("mousemove", function () {
                        mouseMovements++;
                    });

                    // Track keystrokes
                    emailInput.addEventListener("keydown", function () {
                        keystrokes++;
                    });

                    // Track focus events
                    emailInput.addEventListener("focus", function () {
                        focusEvents++;
                    });

                    // Generate token when user starts interacting
                    emailInput.addEventListener("input", function () {
                        if (!submissionToken && this.value.length === 1) {
                            submissionToken = generateSubmissionToken();
                            formLoadTime = Date.now();
                        }
                    });
                }

                // Initialize bot detection
                setupBotDetection();

                if (form) {
                    form.addEventListener("submit", function (e) {
                        e.preventDefault();

                        const email = emailInput.value.trim();
                        const websiteHoneypot =
                            document.getElementById("website").value;
                        const phoneHoneypot =
                            document.getElementById("phone").value;
                        const companyHoneypot =
                            document.getElementById("company").value;

                        // Basic validation
                        if (!email) {
                            showMessage(
                                "Please enter your email address.",
                                "error"
                            );
                            return;
                        }

                        if (!validateEmail(email)) {
                            showMessage(
                                "Please enter a valid email address.",
                                "error"
                            );
                            return;
                        }

                        // Enhanced honeypot checks
                        if (
                            websiteHoneypot.length > 0 ||
                            phoneHoneypot.length > 0 ||
                            companyHoneypot.length > 0
                        ) {
                            showMessage(
                                "Submission failed. Please try again.",
                                "error"
                            );
                            return;
                        }

                        // Enhanced bot protection checks
                        const submissionTime = Date.now();
                        if (submissionTime - formLoadTime < 3000) {
                            showMessage(
                                "Please take a moment before submitting.",
                                "error"
                            );
                            return;
                        }

                        // Check for human-like interaction
                        if (mouseMovements < 3 && keystrokes < 3) {
                            showMessage(
                                "Please interact with the form naturally before submitting.",
                                "error"
                            );
                            return;
                        }

                        // Generate token if not already generated
                        if (!submissionToken) {
                            submissionToken = generateSubmissionToken();
                        }

                        // Show loading state
                        setButtonState(true);
                        formMessage.style.display = "none";

                        // Prepare enhanced data for submission
                        const formData = {
                            email: email,
                            website: websiteHoneypot,
                            phone: phoneHoneypot,
                            company: companyHoneypot,
                            token: submissionToken,
                            timestamp: new Date().toISOString(),
                        };

                        // Submit to Google Apps Script
                        fetch(SCRIPT_URL, {
                            method: "POST",
                            mode: "no-cors", // Required for Google Apps Script
                            headers: {
                                "Content-Type": "application/json",
                            },
                            body: JSON.stringify(formData),
                        })
                            .then(() => {
                                // Since we use no-cors, we can't read the response
                                // But we assume success if no error is thrown
                                showMessage(
                                    "Thanks! You've been added to our mailing list.",
                                    "success"
                                );
                                form.reset(); // Clear the form
                                formLoadTime = Date.now(); // Reset timing for potential resubmission
                            })
                            .catch((error) => {
                                console.error("Submission error:", error);
                                showMessage(
                                    "Something went wrong. Please try again or contact us directly.",
                                    "error"
                                );
                            })
                            .finally(() => {
                                setButtonState(false);
                            });
                    });

                    // Reset form load time when user starts typing (for legitimate resubmissions)
                    emailInput.addEventListener("input", function () {
                        if (this.value.length === 1) {
                            formLoadTime = Date.now();
                        }
                    });
                }
            })();
        </script>
    </body>
</html>
